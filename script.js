class t{constructor(){this.loadInitialData(),this.events=new Map}loadInitialData(){this.roomName="",this.roomsVisiteds=this.loadStorageItem("roomsVisiteds",[]),this.cota=this.loadStorageItem("roomsId",[],!0),this.lastCota=parseInt(localStorage.getItem("lastCota"))||0,this.startedCota="true"===localStorage.getItem("startedCota"),this.eventsHeld=parseInt(localStorage.getItem("eventsHeld"))||1,this.modEventsHeld=this.roomsVisiteds.length||1}loadStorageItem(t,e,n=!1){const o=localStorage.getItem(t);return o?n?this.convertRoomsId(o):JSON.parse(o):e}convertRoomsId(t){return t.split(",").map((t=>t.trim())).filter((t=>t))}init(){this.observeMutations(),this.createLayout(),setTimeout((()=>this.registerEvents()),1e3)}observeMutations(){new MutationObserver((t=>{t.forEach((t=>t.addedNodes.forEach((t=>this.handleMutation(t)))))})).observe(document.querySelector("#root"),{childList:!0,subtree:!0})}handleMutation(t){const e=this.events.get(`.${t.className}`)||this.events.get(`#${t.id}`);e&&e(t)}createLayout(){const t=$('<div id="custom-layout"></div>')[0];document.body.appendChild(t),this.injectCustomLayout(),this.injectStyles()}injectCustomLayout(){$("#custom-layout").html(`\n <div class="main-container">\n <div class="tw-flex tw-justify-between tw-items-center tw-w-full tw-font-bold">\n <span class="tw-flex tw-items-center">\n <img src="https://i.imgur.com/RBmd5uc.png" class="tw-mr-2">\n Ferramenta da Moderação\n </span>\n <div class="closeButton tw-flex">\n <div class="minimize-container" id="minimize_mod_tools">\n <i class="fas fa-window-minimize minimize"></i>\n </div>\n <div class="close-container" id="close_mod_tools">\n <i class="fa-solid fa-square-xmark close"></i>\n </div>\n </div>\n </div>\n\n <hr class="tw-my-[5px] tw-w-full tw-border-t-[1px] tw-border-b-[1px] tw-border-t-[rgba(0,0,0,0.1)] tw-border-b-[rgba(50,50,50,1)]">\n\n <div class="container_buttons">\n <div class="container_button">\n <label class="cb-txt">Iniciar Cota</label>\n <button class="btn_send" id="start_cota">Enviar</button>\n </div>\n\n <div class="container_button">\n <label class="cb-txt">Fechar Cota</label>\n <button class="btn_send" id="close_cota">Enviar</button>\n </div>\n\n <div class="container_button">\n <label class="cb-txt">Chamar EV</label>\n <button class="btn_send" id="summon_cota">Enviar</button>\n </div>\n\n <div class="container_button">\n <label class="cb-txt">Kikar Todos os Usuários</label>\n <button class="btn_send" id="roomkick">Enviar</button>\n </div>\n\n <div class="container_button">\n <label class="cb-txt">Mutar o Quarto</label>\n <button class="btn_send" id="roommute">Enviar</button>\n </div>\n \n <div class="container_button">\n <label class="cb-txt">Cota Automática</label>\n <label class="switch" id="enable_automatic_cota"><input type="checkbox"><span class="slider"></span></label>\n </div>\n \n <div class="container_button cota_automatic">\n <label class="cb-txt">Iniciar Cota Automática</label>\n <button class="btn_send" id="automatic_cota">Enviar</button>\n </div>\n \n <div class="container_button">\n <label class="cb-txt cota_automatic">Pegar ID do quarto atual</label>\n <button class="btn_send cota_automatic" id="get_room_id">Enviar</button>\n </div>\n \n <div class="container_inputs">\n <label class="label_info" for="nameInput">Digite seu nome (MOD):</label>\n <input type="text" id="nameInput" class="input_info" value="${localStorage.getItem("modName")||""}">\n \n <label class="label_info cota_automatic" for="roomsId">Digite os IDs dos quartos (separe por vírgula):</label>\n <input type="text" id="roomsId" class="input_info cota_automatic" value="${localStorage.getItem("roomsId")||""}">\n \n <label for="cotas_done" class="label_info cota_automatic">Contagem dos seus Eventos</label>\n <input type="number" id="cotas_done" class="input_info cota_automatic" value="${this.modEventsHeld}">\n \n <label for="indexCota" class="label_info cota_automatic">Contagem dos Eventos em Geral</label>\n <input type="number" id="indexCota" class="input_info cota_automatic" value="${this.eventsHeld}">\n </div>\n\n <div class="container_button">\n <label class="cb-txt" id="events_quantity">Quantidade de Eventos já realizados: ${this.roomsVisiteds.length}</label>\n <button class="btn_send" id="clear">Limpar</button>\n </div>\n </div>\n </div>\n `)}injectStyles(){$("head").append("\n <style>\n .cb-txt {\n width: 150px;\n margin-top: 6px;\n }\n \n .cb-p {\n font-size: 8px;\n margin-top: 3px;\n color: #515057;\n }\n \n .main-container {\n font-weight: 700;\n position: absolute;\n top: 15vh;\n left: 8%;\n font-size: 10px;\n font-family: Verdana;\n font-style: normal;\n line-height: normal;\n color: #fff;\n width: 250px;\n height: auto;\n overflow: hidden;\n border-radius: 3px;\n background: rgba(28,30,34,.95);\n box-shadow: 0 3px rgba(255,255,255,.05) inset, 0 -3px rgba(0,0,0,.25) inset;\n display: inline-flex;\n padding: 10px 7px;\n flex-direction: column;\n }\n \n .container_buttons {\n /*text-align: center;*/\n display: flex;\n flex-direction: column;\n gap: 10px;\n align-items: center;\n font-size: 10px;\n width: 100%;\n }\n \n .container_button {\n display: flex;\n flex-direction: column;\n flex-direction: row;\n gap: 15px;\n }\n \n .btn_send {\n background: #1ecb2f;\n background-image: -webkit-linear-gradient(top, #1ecb2f, 1dc32d);\n background-image: -moz-linear-gradient(top, #1ecb2f, 1dc32d);\n background-image: -ms-linear-gradient(top, #1ecb2f, 1dc32d);\n background-image: -o-linear-gradient(top, #1ecb2f, 1dc32d);\n background-image: linear-gradient(to bottom, #1ecb2f, 1dc32d);\n -webkit-border-radius: 3;\n -moz-border-radius: 3;\n border-radius: 3px;\n font-family: Arial;\n color: #ffffff;\n font-size: 10px;\n padding: 5px;\n border: solid #21b930 2px;\n text-decoration: none;\n }\n \n .icon-mod_tools {\n background: url('https://i.imgur.com/RBmd5uc.png') no-repeat;\n width: 20px;\n height: 22px;\n }\n \n .modal_content {\n position: relative;\n display: flex;\n flex-direction: column;\n width: 100%;\n pointer-events: auto;\n }\n \n .container_inputs {\n display: flex;\n flex-direction: column;\n text-align: center;\n gap: 5px;\n margin-top: 8px;\n }\n \n .input_info {\n width: fit-content;\n align-self: center;\n padding: 5px;\n border-radius: 3px;\n border: 1px solid #05ff0d;\n background-color: #fff;\n color: #000;\n }\n </style>")}registerEvents(){this.events.set(".w-100 h-100",(()=>{this.events.delete(".w-100 h-100"),this.createElementDraggable("main-container")})),this.events.set(".d-flex flex-column gap-2 align-items-center justify-content-center",(t=>{setTimeout((()=>{const e=$(t).find(".d-flex.flex-column.gap-1")[0],n=$(e).children().first()[0];n&&n.innerText.startsWith("[E")&&(this.roomName=n.innerText)}),1e3)})),this.events.set(".d-flex gap-2 nitro-room-tools-container room-widget-open",(()=>{const t=$(".nitro-room-tools")[0];if(t.querySelector(".icon-mod_tools"))return;const e=$('<div class="cursor-pointer icon icon-mod_tools" title="Ferramenta da Moderação"></div>')[0];t.append(e),e.addEventListener("click",(()=>{$("#custom-layout").show()}))})),this.setupEventHandlers()}setupEventHandlers(){$("#minimize_mod_tools").on("click",(()=>{const t=$(".main-container")[0];"40px"===t.style.height?(t.style.height="auto",t.style.width="250px"):(t.style.height="50px",t.style.width="35px")})),$("#nameInput").on("change",(t=>{localStorage.setItem("modName",t.target.value)})),$("#start_cota").on("click",this.digitarNoChatInput.bind(this)),$("#close_cota").on("click",this.digitarcloseNoChatInput.bind(this)),$("#automatic_cota").on("click",this.comecarCotaAutomaticaInput.bind(this)),$("#summon_cota").on("click",this.digitarEVNoChatInput.bind(this)),$("#roomkick").on("click",this.digitarRoomKickNoChatInput.bind(this)),$("#roommute").on("click",this.digitarRoomMuteNoChatInput.bind(this)),$("#close_mod_tools").on("click",this.closeModTools.bind(this)),$("#get_room_id").on("click",this.getRoomId.bind(this)),$("#clear").on("click",this.clearEvents.bind(this)),$("#enable_automatic_cota").on("click",this.enableAutomaticCota.bind(this)),$("#roomsId").on("change",(t=>this.updateRoomsId(t).bind(this))),$("#indexCota").on("change",(t=>this.updateEventsHeld(t))),$("#cotas_done").on("change",(t=>this.updateModEventsHeld(t))),$(".cota_automatic").hide(),$(".tw-mr-2").on("click",(()=>{const t=$(".main-container")[0];t.style.height="auto",t.style.width="250px"}))}alert(t){}createElementDraggable(t){const e=document.querySelector("."+t);let n,o,a=!1;e.addEventListener("mousedown",(t=>{t.target.matches("input")||t.target.closest("input")||(a=!0,n=t.clientX-e.getBoundingClientRect().left,o=t.clientY-e.getBoundingClientRect().top)})),document.addEventListener("mousemove",(t=>{if(a){const a=t.clientX-n,i=t.clientY-o;e.style.left=`${a}px`,e.style.top=`${i}px`}})),document.addEventListener("mouseup",(()=>{a=!1}))}dispatchEnterEvent(t){const e=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,which:13,bubbles:!0});t.dispatchEvent(e)}typeInChatInput(t){const e=$(".chat-input")[0];if(!e)throw new Error("Chat input not found!");e.value=t,e.dispatchEvent(new Event("input")),this.dispatchEnterEvent(e),e.value="",t.startsWith(":")&&(":ev"===t&&this.alert("Todos foram chamados para o quarto."),this.roomName&&!this.roomsVisiteds.includes(this.roomName)&&(this.roomsVisiteds.push(this.roomName),$("#events_quantity").text(`Quantidade de Eventos já realizados: ${this.roomsVisiteds.length}`),localStorage.setItem("roomsVisiteds",this.roomsVisiteds.join(","))))}digitarNoChatInput(){this.typeInChatInput(":iniciarcota"),this.alert("Cota iniciada."),this.startedCota=!0}digitarRoomKickNoChatInput(){this.typeInChatInput(":roomkick amo voces"),this.alert("Todos foram kikados do quarto.")}digitarRoomMuteNoChatInput(){this.typeInChatInput(":roommute")}digitarcloseNoChatInput(){this.startedCota&&(this.typeInChatInput(":fecharcota"),this.alert("Cota finalizada")),this.startedCota=!1,this.showEventsVisiteds()}digitarEVNoChatInput(){this.typeInChatInput(":ev"),setTimeout((()=>{this.startedCota&&(this.typeInChatInput("eae como ces ta, bora para mais um evento do hubbe?"),setTimeout((()=>{this.startedCota&&this.typeInChatInput("alguma questao amigos? bem facil esse ev aq")}),3e3),setTimeout((()=>{this.startedCota&&this.typeInChatInput("começando o evento amigos")}),9e3))}),1e3)}comecarCotaAutomaticaInput(){digitarRoomKickNoChatInput.bind(this)();const t=$("#nameInput").val();if(t){if(this.lastCota===this.cota.length)return this.lastCota=0,this.alert("Cota esgotada!"),void this.digitarcloseNoChatInput.bind(this)();this.typeInChatInput(`:enviaruser ${t} ${this.cota[this.lastCota++]}`),setTimeout((()=>{this.typeInChatInput(":desativar enable")}),100),setTimeout((()=>{this.typeInChatInput(":ev")}),1e3)}else this.alert("Digite seu nome de MOD no campo de texto!")}closeModTools(){$("#custom-layout").hide()}closeAllTabsFromRoomId(){$(".nitro-card-header-close").click()}getRoomId(){this.clickOnElement($('div[class="cursor-pointer icon icon-cog"]')[0]),setTimeout((()=>{this.clickOnElement($('svg[class="cursor-pointer fa-icon"]')[0]),setTimeout((()=>{const t=$('input[class="form-control form-control-sm"]').val().replace("https://hubbe.biz/room/","");return t?this.cota.includes(t)?(this.closeAllTabsFromRoomId(),void this.alert("Quarto já adicionado!")):(this.cota.push(t),localStorage.setItem("roomsId",this.cota.join(",")),$("#roomsId").val(this.cota.join(",")),void this.closeAllTabsFromRoomId()):(this.closeAllTabsFromRoomId(),void this.alert("ID do quarto não encontrado!"))}),100)}),100)}clickOnElement(t){t&&t.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))}clearEvents(){this.roomsVisiteds=[],this.eventsHeld=0,this.modEventsHeld=0,this.lastCota=0,localStorage.removeItem("eventsHeld"),localStorage.removeItem("roomsVisiteds"),localStorage.removeItem("lastCota"),$("#events_quantity").text(`Quantidade de Eventos já realizados: ${this.roomsVisiteds.length}`),$("#cotas_done").val(0),$("#indexCota").val(0)}enableAutomaticCota(){setTimeout((()=>{const t=$("#enable_automatic_cota").find(".slider")[0];window.getComputedStyle(t).getPropertyValue("background-color").replace("rgb(","").replace(")","").split(", ")[0]>100?$(".cota_automatic").show():$(".cota_automatic").hide()}),50)}updateEventsHeld(t){this.eventsHeld=parseInt(t.target.value),localStorage.setItem("eventsHeld",this.eventsHeld),$("#indexCota").val(this.eventsHeld),$("#events_quantity").text(`Quantidade de Eventos já realizados: ${this.roomsVisiteds.length}`)}updateModEventsHeld(t){this.modEventsHeld=parseInt(t.target.value),localStorage.setItem("modEventsHeld",this.modEventsHeld),$("#cotas_done").val(this.modEventsHeld),$("#events_quantity").text(`Quantidade de Eventos já realizados: ${this.roomsVisiteds.length}`)}updateRoomsId(t){this.cota=this.convertRoomsId(t.target.value),localStorage.setItem("roomsId",t.target.value),this.lastCota=0,localStorage.setItem("lastCota",this.lastCota)}showEventsVisiteds(){const t=`\n <div class="main-container modal_events" style="left: 587px; top: 131px;">\n <div class="tw-flex tw-justify-between tw-items-center tw-w-full tw-font-bold">\n <span class="tw-flex tw-items-center">\n <img src="https://i.imgur.com/RBmd5uc.png" class="tw-mr-2">\n Eventos Realizados\n </span>\n \n <div class="closeButton tw-flex">\n <div class="close-container" id="modal_close">\n <i class="fa-solid fa-square-xmark close"></i>\n </div>\n </div>\n </div>\n \n <hr class="tw-my-[5px] tw-w-full tw-border-t-[1px] tw-border-b-[1px] tw-border-t-[rgba(0,0,0,0.1)] tw-border-b-[rgba(50,50,50,1)]">\n \n <div class="modal_content">\n ${`\n <table>\n <tr>\n <th>Ordem</th>\n <th>Evento</th>\n </tr>\n ${this.roomsVisiteds.map(((t,e)=>`\n <tr>\n <td>${e+1}º</td>\n <td>${t}</td>\n </tr>\n `)).join("")}\n </table>\n `}\n </div>\n \n <div class="container_buttons" style="margin-top: 10px;">\n <div class="container_button" style="width: 100%;">\n <button class="btn_send" id="copy">Copiar Cota</button>\n </div>\n </div>\n </div>\n `;$("#custom-layout").append(t),$("#modal_close").click((()=>{$(".modal_events").remove()})),$("#copy").click((()=>{(!this.modEventsHeld||this.modEventsHeld<1)&&(this.modEventsHeld=1),(!this.eventsHeld||this.eventsHeld<1)&&(this.eventsHeld=1);const t=this.roomsVisiteds.map((t=>`${this.modEventsHeld<10?"0":""}${this.modEventsHeld++}.${this.eventsHeld<10?"0":""}${this.eventsHeld++} ${t}\n**Finalizado**`)).join("\n");navigator.clipboard.writeText(t).then((()=>{this.alert("Cota copiada!")})),localStorage.setItem("eventsHeld",this.eventsHeld),$("#indexCota").val(this.eventsHeld),$("#cotas_done").val(this.modEventsHeld)})),this.createElementDraggable("modal_events")}}(new t).init();